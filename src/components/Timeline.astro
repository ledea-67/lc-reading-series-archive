---
/**
 * Timeline â€” The Archive
 *
 * The organizational spine of the archive.
 * Vertical layout with years as chapter markers, writers branching off.
 * Each year feels significant, marking a chapter in literary history.
 */
interface YearData {
  year: number;
  count: number;
}

interface Props {
  years: YearData[];
  currentYear?: number;
  compact?: boolean;
}

const { years, currentYear, compact = false } = Astro.props;
---

<nav class:list={['timeline', { 'timeline-compact': compact }]} aria-label="Timeline navigation">
  <div class="timeline-track">
    <div class="timeline-line"></div>

    <ol class="timeline-years" role="list">
      {years.map((item, index) => (
        <li
          class:list={['timeline-item', { 'is-current': item.year === currentYear }]}
          style={`animation-delay: ${index * 30}ms`}
        >
          <a href={`/years/${item.year}`} class="timeline-link">
            <span class="timeline-marker"></span>
            <span class="timeline-year">{item.year}</span>
            {!compact && (
              <span class="timeline-count">
                {item.count} {item.count === 1 ? 'writer' : 'writers'}
              </span>
            )}
          </a>
        </li>
      ))}
    </ol>
  </div>
</nav>

<style>
  .timeline {
    position: relative;
    padding: var(--space-4) 0;
  }

  .timeline-track {
    position: relative;
  }

  .timeline-line {
    position: absolute;
    left: 6px;
    top: 0;
    bottom: 0;
    width: 1px;
    background: linear-gradient(
      to bottom,
      transparent,
      var(--rule-light) 5%,
      var(--rule-light) 95%,
      transparent
    );
  }

  .timeline-years {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
  }

  .timeline-item {
    position: relative;
    padding-left: var(--space-8);
    animation: settle var(--duration-slower) var(--ease-out) forwards;
    opacity: 0;
    transform: translateY(8px);
  }

  .timeline-link {
    display: flex;
    align-items: baseline;
    gap: var(--space-3);
    text-decoration: none;
    color: inherit;
    transition: var(--transition-color);
  }

  .timeline-link:hover .timeline-year {
    color: var(--accent-stamp);
  }

  .timeline-link:hover .timeline-marker {
    background: var(--accent-stamp);
    transform: scale(1.3);
  }

  .timeline-marker {
    position: absolute;
    left: 2px;
    top: 50%;
    transform: translateY(-50%);
    width: 9px;
    height: 9px;
    border-radius: 50%;
    background: var(--rule-medium);
    border: 2px solid var(--paper-warm);
    transition:
      background var(--duration-fast) var(--ease-out),
      transform var(--duration-fast) var(--ease-out);
  }

  .is-current .timeline-marker {
    background: var(--accent-stamp);
    width: 11px;
    height: 11px;
    left: 1px;
  }

  .timeline-year {
    font-family: var(--font-display);
    font-size: var(--text-lg);
    font-weight: 500;
    font-variant-numeric: oldstyle-nums;
    color: var(--ink-deep);
    line-height: 1;
    transition: var(--transition-color);
  }

  .is-current .timeline-year {
    color: var(--accent-stamp);
  }

  .timeline-count {
    font-family: var(--font-ui);
    font-size: var(--text-xs);
    font-style: italic;
    color: var(--ink-muted);
    letter-spacing: var(--tracking-wide);
  }

  /* Compact mode - horizontal layout */
  .timeline-compact .timeline-track {
    overflow-x: auto;
    padding-bottom: var(--space-2);
  }

  .timeline-compact .timeline-line {
    left: 0;
    right: 0;
    top: 50%;
    bottom: auto;
    width: auto;
    height: 1px;
    background: linear-gradient(
      to right,
      transparent,
      var(--rule-light) 5%,
      var(--rule-light) 95%,
      transparent
    );
  }

  .timeline-compact .timeline-years {
    flex-direction: row;
    gap: var(--space-6);
    padding: var(--space-4) 0;
  }

  .timeline-compact .timeline-item {
    padding-left: 0;
    padding-top: var(--space-6);
  }

  .timeline-compact .timeline-marker {
    left: 50%;
    top: 0;
    transform: translateX(-50%);
  }

  .timeline-compact .is-current .timeline-marker {
    left: 50%;
  }

  .timeline-compact .timeline-link {
    flex-direction: column;
    align-items: center;
    gap: var(--space-1);
  }

  .timeline-compact .timeline-year {
    font-size: var(--text-base);
  }

  /* Scrollbar styling for compact */
  .timeline-compact .timeline-track::-webkit-scrollbar {
    height: 4px;
  }

  .timeline-compact .timeline-track::-webkit-scrollbar-track {
    background: var(--rule-faint);
    border-radius: 2px;
  }

  .timeline-compact .timeline-track::-webkit-scrollbar-thumb {
    background: var(--rule-light);
    border-radius: 2px;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .timeline-years {
      gap: var(--space-2);
    }

    .timeline-year {
      font-size: var(--text-base);
    }

    .timeline-compact .timeline-years {
      gap: var(--space-4);
    }
  }
</style>
